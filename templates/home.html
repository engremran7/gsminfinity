{% extends "base.html" %}
{% load static %}
{% block title %}Home — {{ site_settings.site_name|default:"" }}{% endblock %}

{% block content %}

<!-- HERO SECTION -->
<section class="py-20 bg-white text-center">
  <div class="container mx-auto px-4">
    <h1 class="text-4xl md:text-5xl font-extrabold text-primary mb-4">
      Welcome to {{ site_settings.site_name|default:"" }}
    </h1>

    <p class="text-gray-600 text-lg">
      Django {{ django_version }} • Python {{ python_version }} · {{ now }}
    </p>

    <!-- Metrics Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mt-12">

      <!-- Total Users -->
      <div class="bg-white shadow-md rounded-xl p-6 text-center border border-gray-100">
        <h3 class="text-3xl font-bold text-gray-800">{{ total_users|default:"—" }}</h3>
        <p class="text-gray-500 text-sm mt-1">Total users</p>
      </div>

      <!-- Active Devices -->
      <div class="bg-white shadow-md rounded-xl p-6 text-center border border-gray-100">
        <h3 class="text-3xl font-bold text-gray-800">{{ active_devices|default:"—" }}</h3>
        <p class="text-gray-500 text-sm mt-1">Active devices</p>
      </div>

      <!-- Unread Notifications -->
      <div class="bg-white shadow-md rounded-xl p-6 text-center border border-gray-100">
        <h3 class="text-3xl font-bold text-gray-800">{{ unread_notifications|default:"—" }}</h3>
        <p class="text-gray-500 text-sm mt-1">Unread notifications</p>
      </div>

      <!-- Active Announcements -->
      <div class="bg-white shadow-md rounded-xl p-6 text-center border border-gray-100">
        <h3 class="text-3xl font-bold text-gray-800">{{ active_announcements|default:"—" }}</h3>
        <p class="text-gray-500 text-sm mt-1">Active announcements</p>
      </div>

    </div>
  </div>
</section>


<!-- ANNOUNCEMENTS LIST -->
<section class="container mx-auto mt-16 px-4">
  <h2 class="text-2xl font-bold mb-6">Recent announcements</h2>

  {% if announcements %}
    <div class="space-y-4">
      {% for a in announcements %}
        <div class="bg-white border border-gray-200 p-5 rounded-xl shadow-sm">
          <h5 class="text-xl font-semibold text-gray-800">{{ a.title|default:"(untitled)" }}</h5>
          <p class="text-gray-400 text-sm">{{ a.created_at|date:"M d, Y" }}</p>

          <p class="text-gray-700 mt-2">
            {{ a.message|truncatechars:200 }}
          </p>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="bg-blue-50 text-blue-700 border border-blue-200 p-4 rounded-lg">
      No announcements available.
    </div>
  {% endif %}
</section>


<!-- Consent banner target container -->
<div id="consent-banner" aria-live="polite"></div>

{% endblock %}


{% block scripts %}
<!-- Load consent banner loader from static (CSP-safe: nonce injected automatically) -->
<script src="{% static 'js/consent-banner-loader.js' %}" nonce="{{ request.csp_nonce }}"></script>
{% endblock %}
